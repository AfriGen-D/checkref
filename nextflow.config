// Global default params
params {
    // Input/output options
    targetVcfs = null
    referenceDir = null
    legendPattern = "*.legend.gz"
    outputDir = "results"
    fixMethod = "remove"  // Options: "remove" or "correct"
    help = false
    
    // Max resources
    maxCpus = 4
    maxMemory = 8.GB
    maxTime = 24.h
}

// Process resource allocation
process {
    // Default resources for all processes
    cpus = 1
    memory = 4.GB
    time = 1.h

    // Process-specific resources and containers
    withName: CHECK_ALLELE_SWITCH {
        cpus = 1
        memory = 4.GB
        time = 4.h
        container = 'docker://mamana/vcf-processing:latest'
    }

    withName: REMOVE_SWITCHED_SITES {
        container = 'docker://mamana/vcf-processing:latest'
    }

    withName: CORRECT_SWITCHED_SITES {
        container = 'docker://mamana/vcf-processing:latest'
    }
}

// Profiles
profiles {
    // Default profile for local execution
    standard {
        process.executor = 'local'
    }
    
    // Profile for high-performance computing environments
    hpc {
        process.executor = 'slurm'
        process.queue = 'normal'
        process.clusterOptions = '--account=project123'
    }
    
    // Docker profile
    docker {
        docker.enabled = true
    }

    // Singularity profile
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
    }
}

// Execution reports
report {
    enabled = true
    file = "${params.outputDir}/reports/execution_report.html"
    overwrite = true
}

timeline {
    enabled = true
    file = "${params.outputDir}/reports/timeline_report.html"
    overwrite = true
}

dag {
    enabled = true
    file = "${params.outputDir}/reports/dag_report.html"
    overwrite = true
}

// Manifest
manifest {
    name = 'Allele Switch Checker'
    author = 'Bioinformatics Team'
    description = 'Nextflow workflow to check allele switches between target VCF and reference panel VCF'
    version = '1.0.0'
    mainScript = 'main.nf'
    nextflowVersion = '>=21.04.0'
} 